<!doctype html><html lang=en><head><title>SQLite no es una base de datos de juguete ::
Sysarmy — El blog de quienes dan soporte</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Ya sea que trabajes en desarrollo, analisis de datos, control de calidad, DevOps o producto, SQLite es una herramienta perfecta para vos. Aquí contamos por que.
Algunos hechos bien conocidos para comenzar: SQLite es el DBMS más común del mundo, incluido en todos los sistemas operativos populares. SQLite no tiene servidor. Para quienes desarrollan, SQLite está integrado directamente en la aplicación. Para todos los demás, existe una conveniente consola de base de datos (REPL), que se proporciona como un solo archivo (sqlite3.exe en Windows, sqlite3 en Linux / macOS). "><meta name=keywords content="sqlite,bases de datos,dba"><meta name=robots content="noodp"><link rel=canonical href=https://sysarmy.com/blog/posts/sqlite-no-es-una-base-de-datos-de-juguete/><link rel=stylesheet href=https://sysarmy.com/blog/assets/style.css><link rel=stylesheet href=https://sysarmy.com/blog/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://sysarmy.com/blog/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://sysarmy.com/blog/img/favicon.png><link href=https://sysarmy.com/blog/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://sysarmy.com/blog/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://sysarmy.com/blog/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://sysarmy.com/blog/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://sysarmy.com/blog/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://sysarmy.com/blog/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="SQLite no es una base de datos de juguete"><meta name=twitter:description content="SQLite no es una base de datos de juguete"><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-MW9RRK2")</script><script>function loadScript(e){var n=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://tracker.metricool.com/resources/be.js",t.onreadystatechange=e,t.onload=e,n.appendChild(t)}loadScript(function(){beTracker.t({hash:"b5c0b4816e829c93645aa7ad738aa3c0"})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-K4QJX7Y34Y"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K4QJX7Y34Y")</script></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/blog class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>sysarmy:~ blog$</span>
<span class=logo__cursor></span>
</a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://tienda.sysarmy.com/>Tienda</a></li><li><a href=https://www.youtube.com/channel/UCPE3EUzO58EBHzrJp2Fv7_A>Youtube</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://tienda.sysarmy.com/>Tienda</a></li><li><a href=https://www.youtube.com/channel/UCPE3EUzO58EBHzrJp2Fv7_A>Youtube</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>SQLite no es una base de datos de juguete</h1><div class=post-meta><span class=post-date>April 1, 2021
</span><span class=post-read-time>— 9 minutos de lectura aprox.</span></div><span class=post-tags><a href=https://sysarmy.com/blog/tags/sqlite/>#sqlite</a>&nbsp;
<a href=https://sysarmy.com/blog/tags/bases-de-datos/>#bases de datos</a>&nbsp;
<a href=https://sysarmy.com/blog/tags/dba/>#dba</a>&nbsp;</span><figure class=post-cover><img src=https://sysarmy.com/blog/assets/sqlite-no-es-una-base-de-datos-de-juguete.svg alt="SQLite no es una base de datos de juguete"></figure><div class=post-content><base href=https://sysarmy.com/blog/><p>Ya sea que trabajes en desarrollo, analisis de datos, control de calidad, DevOps o producto, <a href=https://www.sqlite.org/>SQLite</a> es una herramienta perfecta para vos. Aquí contamos por que.</p><h2 id=algunos-hechos-bien-conocidos-para-comenzar>Algunos hechos bien conocidos para comenzar:</h2><ul><li>SQLite es el DBMS más común del mundo, incluido en todos los sistemas operativos populares.</li><li>SQLite no tiene servidor.</li><li>Para quienes desarrollan, SQLite está integrado directamente en la aplicación.</li><li>Para todos los demás, existe una conveniente consola de base de datos (REPL), que se proporciona como un solo archivo (sqlite3.exe en Windows, sqlite3 en Linux / macOS).</li></ul><h1 id=consola-importación-y-exportación>Consola, importación y exportación</h1><p>La consola es una característica excelente de SQLite para el análisis de datos: más poderosa que Excel y más simple que <code>pandas</code>. Se pueden importar datos CSV con un solo comando y la tabla se crea automáticamente:</p><pre><code>&gt; .import --csv city.csv city
&gt; select count(*) from city;
1117
</code></pre><p>La consola admite funciones básicas de SQL y muestra los resultados de las consultas en una bonita tabla dibujada en ASCII. Las funciones avanzadas de SQL también son compatibles, pero más sobre eso más adelante.</p><pre><code>select
  century || ' century' as dates,
  count(*) as city_count
from history
group by century
order by century desc;

┌────────────┬────────────┐
│   dates    │ city_count │
├────────────┼────────────┤
│ 21 century │ 1          │
│ 20 century │ 263        │
│ 19 century │ 189        │
│ 18 century │ 191        │
│ 17 century │ 137        │
│ ...        │ ...        │
└────────────┴────────────┘
</code></pre><p>Los datos se pueden exportar como SQL, CSV, JSON, incluso Markdown y HTML. Toma solo un par de comandos:</p><pre><code>.mode json
.output city.json
select city, foundation_year, timezone from city limit 10;
.shell cat city.json
[
    { &quot;city&quot;: &quot;Amsterdam&quot;, &quot;foundation_year&quot;: 1300, &quot;timezone&quot;: &quot;UTC+1&quot; },
    { &quot;city&quot;: &quot;Berlin&quot;, &quot;foundation_year&quot;: 1237, &quot;timezone&quot;: &quot;UTC+1&quot; },
    { &quot;city&quot;: &quot;Helsinki&quot;, &quot;foundation_year&quot;: 1548, &quot;timezone&quot;: &quot;UTC+2&quot; },
    { &quot;city&quot;: &quot;Monaco&quot;, &quot;foundation_year&quot;: 1215, &quot;timezone&quot;: &quot;UTC+1&quot; },
    { &quot;city&quot;: &quot;Moscow&quot;, &quot;foundation_year&quot;: 1147, &quot;timezone&quot;: &quot;UTC+3&quot; },
    { &quot;city&quot;: &quot;Reykjavik&quot;, &quot;foundation_year&quot;: 874, &quot;timezone&quot;: &quot;UTC&quot; },
    { &quot;city&quot;: &quot;Sarajevo&quot;, &quot;foundation_year&quot;: 1461, &quot;timezone&quot;: &quot;UTC+1&quot; },
    { &quot;city&quot;: &quot;Stockholm&quot;, &quot;foundation_year&quot;: 1252, &quot;timezone&quot;: &quot;UTC+1&quot; },
    { &quot;city&quot;: &quot;Tallinn&quot;, &quot;foundation_year&quot;: 1219, &quot;timezone&quot;: &quot;UTC+2&quot; },
    { &quot;city&quot;: &quot;Zagreb&quot;, &quot;foundation_year&quot;: 1094, &quot;timezone&quot;: &quot;UTC+1&quot; }
]
</code></pre><p>Si sos más un BI que una persona de consola, las herramientas populares de exploración de datos como <a href=https://www.metabase.com/>Metabase</a>, <a href=https://redash.io/>Redash</a> y <a href=https://superset.apache.org/>Superset</a> son compatibles con SQLite.</p><h1 id=json-nativo>JSON nativo</h1><p>No hay nada más conveniente que SQLite para analizar y transformar JSON. Puede seleccionar datos directamente de un archivo como si fuera una tabla normal. O importe datos a la tabla y seleccione desde allí.</p><pre><code>select
  json_extract(value, '$.iso.code') as code,
  json_extract(value, '$.iso.number') as num,
  json_extract(value, '$.name') as name,
  json_extract(value, '$.units.major.name') as unit
from
  json_each(readfile('currency.sample.json'))
;
┌──────┬─────┬─────────────────┬──────────┐
│ code │ num │      name       │   unit   │
├──────┼─────┼─────────────────┼──────────┤
│ ARS  │ 032 │ Argentine peso  | peso     │
│ CHF  │ 756 │ Swiss Franc     │ franc    │
│ EUR  │ 978 │ Euro            │ euro     │
│ GBP  │ 826 │ British Pound   │ pound    │
│ INR  │ 356 │ Indian Rupee    │ rupee    │
│ JPY  │ 392 │ Japanese yen    │ yen      │
│ MAD  │ 504 │ Moroccan Dirham │ dirham   │
│ RUR  │ 643 │ Russian Rouble  │ rouble   │
│ SOS  │ 706 │ Somali Shilling │ shilling │
│ USD  │ 840 │ US Dollar       │ dollar   │
└──────┴─────┴─────────────────┴──────────┘
</code></pre><p>No importa qué tan profundo sea el JSON: puede extraer cualquier objeto anidado :</p><pre><code>select
  json_extract(value, '$.id') as id,
  json_extract(value, '$.name') as name
from
  json_tree(readfile('industry.sample.json'))
where
  path like '$[%].industries'
;
┌────────┬──────────────────────┐
│   id   │         name         │
├────────┼──────────────────────┤
│ 7.538  │ Internet provider    │
│ 7.539  │ IT consulting        │
│ 7.540  │ Software development │
│ 9.399  │ Mobile communication │
│ 9.400  │ Fixed communication  │
│ 9.401  │ Fiber-optics         │
│ 43.641 │ Audit                │
│ 43.646 │ Insurance            │
│ 43.647 │ Bank                 │
└────────┴──────────────────────┘
</code></pre><h1 id=cte-y-operaciones-de-conjuntos>CTE y operaciones de conjuntos</h1><p>Por supuesto, SQLite admite Expresiones de tabla comunes (cláusula <code>WITH</code>) y <code>JOIN</code>, ni siquiera daré ejemplos aquí. Si los datos son jerárquicos (la tabla se refiere a sí misma a través de una columna como parent_id), <code>WITH RECURSIVE</code> será útil. Cualquier jerarquía, por profunda que sea, se puede &ldquo;desenrollar&rdquo; con una sola consulta.</p><pre><code>with recursive tmp(id, name, level) as (
  select id, name, 1 as level
  from area
  where parent_id is null

  union all

  select
    area.id,
    tmp.name || ', ' || area.name as name,
    tmp.level + 1 as level
  from area
    join tmp on area.parent_id = tmp.id
)

select * from tmp;
┌──────┬──────────────────────────┬───────┐
│  id  │           name           │ level │
├──────┼──────────────────────────┼───────┤
│ 93   │ US                       │ 1     │
│ 768  │ US, Washington DC        │ 2     │
│ 1833 │ US, Washington           │ 2     │
│ 2987 │ US, Washington, Bellevue │ 3     │
│ 3021 │ US, Washington, Everett  │ 3     │
│ 3039 │ US, Washington, Kent     │ 3     │
│ ...  │ ...                      │ ...   │
└──────┴──────────────────────────┴───────┘
</code></pre><p>¿Conjuntos? No hay problema: <code>UNION</code>, <code>INTERSECT</code>, <code>EXCEPT</code> están a su servicio.</p><pre><code>select employer_id
from employer_area
where area_id = 1

except

select employer_id
from employer_area
where area_id = 2;
</code></pre><p>¿Calcular una columna basándose en varias otras? Ingrese las columnas generadas:</p><pre><code>alter table vacancy
add column salary_net integer as (
  case when salary_gross = true then
    round(salary_from/1.04)
  else
    salary_from
  end
);
</code></pre><p>Las columnas generadas se pueden consultar de la misma manera que las &rsquo;normales':</p><pre><code>select
  substr(name, 1, 40) as name,
  salary_net
from vacancy
where
  salary_currency = 'JPY'
  and salary_net is not null
limit 10;
</code></pre><h1 id=estadística-matemática>Estadística matemática</h1><p>¿Estadística descriptiva? Fácil: media, mediana, percentiles, desviación estándar, lo que sea. Tendrá que cargar una extensión, pero también es un solo comando (y un solo archivo).</p><pre><code>.load sqlite3-stats

select
  count(*) as book_count,
  cast(avg(num_pages) as integer) as mean,
  cast(median(num_pages) as integer) as median,
  mode(num_pages) as mode,
  percentile_90(num_pages) as p90,
  percentile_95(num_pages) as p95,
  percentile_99(num_pages) as p99
from books;
┌────────────┬──────┬────────┬──────┬─────┬─────┬──────┐
│ book_count │ mean │ median │ mode │ p90 │ p95 │ p99  │
├────────────┼──────┼────────┼──────┼─────┼─────┼──────┤
│ 1483       │ 349  │ 295    │ 256  │ 640 │ 817 │ 1199 │
└────────────┴──────┴────────┴──────┴─────┴─────┴──────┘
</code></pre><blockquote><p>Nota sobre extensiones. A SQLite le faltan muchas funciones en comparación con otros DBMS como PostgreSQL. Pero son fáciles de agregar, que es lo que hace la gente, por lo que resulta bastante complicado.
Por lo tanto, decidí hacer un conjunto consistente de extensiones, dividido por área de dominio y compilado para los principales sistemas operativos. Hay pocos de ellos todavía, pero hay más en camino:
<a href=https://github.com/nalgeon/sqlite-plus/>sqlite-plus @ GitHub</a></p></blockquote><p>Más diversión con las estadísticas. Puede trazar la distribución de datos directamente en la consola. Mira qué lindo que es:</p><pre><code>with slots as (
  select
    num_pages/100 as slot,
    count(*) as book_count
  from books
  group by slot
),
max as (
  select max(book_count) as value
  from slots
)
select
  slot,
  book_count,
  printf('%.' || (book_count * 30 / max.value) || 'c', '*') as bar
from slots, max
order by slot;
┌──────┬────────────┬────────────────────────────────┐
│ slot │ book_count │              bar               │
├──────┼────────────┼────────────────────────────────┤
│ 0    │ 116        │ *********                      │
│ 1    │ 254        │ ********************           │
│ 2    │ 376        │ ****************************** │
│ 3    │ 285        │ **********************         │
│ 4    │ 184        │ **************                 │
│ 5    │ 90         │ *******                        │
│ 6    │ 54         │ ****                           │
│ 7    │ 41         │ ***                            │
│ 8    │ 31         │ **                             │
│ 9    │ 15         │ *                              │
│ 10   │ 11         │ *                              │
│ 11   │ 12         │ *                              │
│ 12   │ 2          │ *                              │
└──────┴────────────┴────────────────────────────────┘
</code></pre><h1 id=performance>Performance</h1><p>SQLite funciona con cientos de millones de registros. Los <code>INSERTS</code> regulares muestran alrededor de 240K registros por segundo en mi computadora portátil. Y si conecta el archivo CSV como una tabla virtual (hay una extensión para eso), las inserciones se vuelven 2 veces más rápidas.</p><pre><code>.load sqlite3-vsv

create virtual table temp.blocks_csv using vsv(
    filename=&quot;ipblocks.csv&quot;,
    schema=&quot;create table x(network text, geoname_id integer, registered_country_geoname_id integer, represented_country_geoname_id integer, is_anonymous_proxy integer, is_satellite_provider integer, postal_code text, latitude real, longitude real, accuracy_radius integer)&quot;,
    columns=10,
    header=on,
    nulls=on
);
.timer on
insert into blocks
select * from blocks_csv;

Run Time: real 5.176 user 4.716420 sys 0.403866
select count(*) from blocks;
3386629

Run Time: real 0.095 user 0.021972 sys 0.063716
</code></pre><p>Existe una opinión popular entre los desarrolladores de que SQLite no es adecuado para la web, porque no admite el acceso concurrente. Esto es un mito. En el modo de registro de escritura anticipada (disponible desde hace mucho tiempo), puede haber tantos lectores simultáneos como desee. Solo puede haber un escritor concurrente, pero a menudo uno es suficiente.</p><p>SQLite es perfecto para aplicaciones y sitios web pequeños. <a href=https://sqlite.org>sqlite.org</a> utiliza SQLite como base de datos, sin preocuparse por la optimización (200 solicitudes por página). Maneja 700K visitas por mes y sirve páginas más rápido que el 95% de los sitios web que he visto.</p><h1 id=documentos-gráficos-y-búsqueda>Documentos, gráficos y búsqueda</h1><p>SQLite admite índices parciales e índices en expresiones, como lo hacen los DBMS &lsquo;grandes&rsquo;. Puede crear índices en columnas generadas e incluso convertir SQLite en una base de datos de documentos. Simplemente almacene JSON sin procesar y cree índices con <code>json_extract()</code>-ed columns:</p><pre><code>create table currency(
  body text,
  code text as (json_extract(body, '$.code')),
  name text as (json_extract(body, '$.name'))
);

create index currency_code_idx on currency(code);

insert into currency
select value
from json_each(readfile('currency.sample.json'));
explain query plan
select name from currency where code = 'EUR';

QUERY PLAN
`--SEARCH TABLE currency USING INDEX currency_code_idx (code=?)
</code></pre><blockquote><p>También puede usar SQLite como una base de datos gráfica. Un montón de complejos WITH RECURSIVE harán el truco, o tal vez prefiera agregar un poco de Python:
<a href=https://github.com/dpapathanasiou/simple-graph>simple-graph @ GitHub</a></p></blockquote><p>La búsqueda de texto completo funciona desde el primer momento:</p><pre><code>create virtual table books_fts
using fts5(title, author, publisher);

insert into books_fts
select title, author, publisher from books;

select
  author,
  substr(title, 1, 30) as title,
  substr(publisher, 1, 10) as publisher
from books_fts
where books_fts match 'ann'
limit 5;
┌─────────────────────┬────────────────────────────────┬────────────┐
│       author        │             title              │ publisher  │
├─────────────────────┼────────────────────────────────┼────────────┤
│ Ruby Ann Boxcar     │ Ruby Ann's Down Home Trailer P │ Citadel    │
│ Ruby Ann Boxcar     │ Ruby Ann's Down Home Trailer P │ Citadel    │
│ Lynne Ann DeSpelder │ The Last Dance: Encountering D │ McGraw-Hil │
│ Daniel Defoe        │ Robinson Crusoe                │ Ann Arbor  │
│ Ann Thwaite         │ Waiting for the Party: The Lif │ David R. G │
└─────────────────────┴────────────────────────────────┴────────────┘
</code></pre><p>Quizás necesite una base de datos en memoria para cálculos intermedios? Una sola línea de código Python:</p><pre><code>db = sqlite3.connect(&quot;:memory:&quot;)
</code></pre><p>Incluso puede acceder a él desde múltiples conexiones:</p><pre><code>db = sqlite3.connect (&quot;file :: memory:? Cache = shared&quot;)
</code></pre><h1 id=y-mucho-más>Y mucho más</h1><p>Allí son funciones de ventana elegantes (como en PostgreSQL). <code>UPSERT</code>, <code>UPDATE FROM</code> y <code>generate_series()</code>. Índices R-Tree. Expresiones regulares, búsqueda difusa y geo. En términos de características, SQLite puede competir con cualquier DBMS &lsquo;grande&rsquo;.</p><p>También hay excelentes herramientas en torno a SQLite. Me gusta especialmente Datasette, una herramienta de código abierto para explorar y publicar conjuntos de datos SQLite. Y DBeaver es un excelente IDE de base de datos de código abierto con soporte para las últimas versiones de SQLite.</p><p>Autor original <a href=https://twitter.com/ohmypy>@ohmypy</a>, <a href=https://antonz.org/sqlite-is-not-a-toy-database/>artículo original</a>, comentarios (que vale la pena leer) en <a href="https://news.ycombinator.com/item?id=26580614">Hacker News</a></p><p>revisó y publicó @jedux.</p><div class=ve-desktop><ins class=dcmads style=display:inline-block;width:728px;height:90px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.251052924 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div><div class=ve-mobile><ins class=dcmads style=display:inline-block;width:320px;height:50px data-dcm-placement=N410401.3634809SYSARMY.COMBLOG/B10464038.250920272 data-dcm-rendering-mode=iframe data-dcm-https-only data-dcm-resettable-device-id data-dcm-app-id><script src=https://www.googletagservices.com/dcm/dcmads.js></script></ins></div><script>if(window.innerWidth<960)for(var divsToHide=document.getElementsByClassName("ve-desktop"),i=0;i<divsToHide.length;i++)divsToHide[i].style.visibility="hidden",divsToHide[i].style.display="none";else for(divsToHide=document.getElementsByClassName("ve-mobile"),i=0;i<divsToHide.length;i++)divsToHide[i].style.visibility="hidden",divsToHide[i].style.display="none"</script></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Leer otros posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://sysarmy.com/blog/posts/entendiendo-la-fork-bomb-de-bash/><span class=button__icon>←</span>
<span class=button__text>Entendiendo la fork() Bomb :(){ :|:& };: de bash</span>
</a></span><span class="button next"><a href=https://sysarmy.com/blog/posts/polemicaenvar-s05e01-ovh-fire/><span class=button__text>Fuego en el Datacenter - El incidente de OVH - Polémica en /var S05E01</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/blog class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>sysarmy:~ blog$</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2025 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://sysarmy.com/blog/assets/main.js></script><script src=https://sysarmy.com/blog/assets/prism.js></script></div></body></html>